"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".body"),t=document.querySelectorAll(".fix-block"),o=document.querySelector(".mobile-menu"),s=document.querySelector(".page__to-top"),i=document.querySelector(".header"),a=document.querySelector(".burger"),r=document.querySelector(".header__nav"),n=document.querySelector(".hero"),d=document.querySelector(".about"),c=document.querySelector(".advantages"),l=document.querySelector(".services"),u=document.querySelector(".partners"),p=(document.querySelector(".overlay"),window.matchMedia("(max-width: 1024px)"));window.matchMedia("(min-width: 1367px)"),document.querySelector(".copyright__year").innerText=(new Date).getFullYear(),window.onresize=(()=>{v()});let m=window.pageYOffset;const y=()=>{i.classList.remove("header--hidden"),i.classList.add("header--fixed")},g=()=>{let e=window.pageYOffset;window.pageYOffset>=i.offsetHeight&&window.pageYOffset<n.offsetHeight?i.classList.add("header--hidden"):window.pageYOffset>=n.offsetHeight?(s.classList.add("page__to-top--visible"),p.matches?(m<e?i.classList.add("header--hidden"):y(),m=e):y()):(i.classList.remove("header--hidden"),i.classList.remove("header--fixed"),s.classList.remove("page__to-top--visible"))};g();const v=()=>{p.matches?(r.classList.add("header__nav--hidden"),o.classList.add("mobile-menu--visible")):(r.classList.remove("header__nav--hidden"),o.classList.remove("mobile-menu--visible"))};v(),a.addEventListener("click",()=>{a.classList.toggle("header__burger--close"),a.classList.contains("header__burger--close")?f():_()});const f=()=>{L(),e.classList.add("body--lock"),o.style.paddingTop=i.offsetHeight+"px",w.timeScale(1).play()},_=()=>{w.timeScale(1.5).reverse(),setTimeout(()=>{e.classList.remove("body--lock"),b()},750*w.duration())};function h(e){window.scroll({left:0,top:e.offsetTop,behavior:"smooth"})}[...document.querySelectorAll("[data-scroll]")].forEach(function(e){e.addEventListener("click",t=>{t.preventDefault();const o=e.getAttribute("data-scroll").replace("#","");e.classList.contains("menu__link")?(a.classList.remove("header__burger--close"),_(),setTimeout(()=>{h(document.getElementById(o))},750*w.duration())):h(document.getElementById(o))})});let L=()=>{let o=window.innerWidth-document.body.offsetWidth+"px";e.classList.add("disable--scroll"),t.forEach(e=>{e.style.paddingRight=o}),document.body.style.paddingRight=o},b=()=>{e.classList.remove("disable--scroll"),t.forEach(e=>{e.style.paddingRight="0px"}),document.body.style.paddingRight="0px"};const w=gsap.timeline({paused:!0,reversed:!0}).set(o,{top:0}).fromTo(".menu-list",{x:"-100vw",opacity:0},{duration:.5,x:0,width:"100%",opacity:1}).from(".menu__link span",{duration:1,y:25,opacity:0,stagger:.25});p.matches||gsap.timeline({paused:!0,reversed:!0}).from(".header__logo-icon",{duration:1,y:15,scale:.75,opacity:0}).from(".header__logo-text",{duration:1,y:15,opacity:0},"-=.5").from(".nav__item",{duration:1,y:25,opacity:0,stagger:.35}).play(),gsap.timeline({paused:!0,reversed:!0}).from(".hero__title",{duration:1,y:75,opacity:0}).from(".hero__descr",{duration:1,y:75,opacity:0},"-=.75").from(".hero__link",{duration:1,scale:.75,opacity:0},"-=.75").play();const S=gsap.timeline({paused:!0,reversed:!0}).from(".about__title",{duration:.75,scale:.75,opacity:0}).from(".about__text",{duration:.75,y:35,opacity:0,stagger:.25}),q=gsap.timeline({paused:!0,reversed:!0}).from(".advantages__item",{duration:1,y:-35,opacity:0,stagger:.25}),k=gsap.timeline({paused:!0,reversed:!0}).from(".services__title",{duration:1,y:-50,opacity:0}).from(".services__text",{duration:.75,y:35,opacity:0,stagger:.25}),E=gsap.timeline({paused:!0,reversed:!0}).from(".partners__item",{duration:.75,y:"random(-35, 35)",opacity:0,stagger:.25}).from(".partners__buttons",{duration:.75,opacity:0},"-=.5"),x=()=>{document.documentElement.clientHeight/2>=d.getBoundingClientRect().top&&S.play(),document.documentElement.clientHeight/2>=c.getBoundingClientRect().top&&q.play(),document.documentElement.clientHeight/2>=l.getBoundingClientRect().top&&k.play(),document.documentElement.clientHeight/2>=u.getBoundingClientRect().top&&E.play()};window.addEventListener("scroll",()=>{x(),g()},{passive:!0});const A=gsap.timeline({paused:!0,reversed:!0}).from(".popup",{duration:1.2,opacity:0,ease:"expo.out",y:-150}).from(".popup",{duration:.5,scale:.85},"-=1");x();const H=document.querySelectorAll(".popups"),R=document.querySelector(".popups__overlay"),T=document.querySelector(".popup-email"),B=document.querySelectorAll(".popup__close"),O=(t,o,s)=>{L(),C(),e.classList.add("body--lock"),t.parentNode.classList.add("popups__overlay--visible"),t.classList.add("popup--active"),A.play(),t.classList.contains("popup-email")&&(t.querySelector(".popup-email__img").setAttribute("src",o),t.querySelector(".popup-email__message").innerText=s)},C=()=>{H.forEach(e=>{e.querySelector(".popup").classList.remove("popup--active")})};R.addEventListener("click",e=>{e.target==R&&D(R)});const D=t=>{b(),e.classList.remove("body--lock"),A.reverse(),t.classList.remove("popups__overlay--visible"),C()};B.forEach(e=>{e.addEventListener("click",function(t){D(e.closest(".popups__overlay")),t.preventDefault()})}),document.addEventListener("keydown",function(e){if(27===e.keyCode&&document.querySelector(".popup--active")){const e=document.querySelector(".popups__overlay--visible");D(e)}});const Y=document.querySelector(".form"),I=document.getElementById("feedback");function M(e){e.classList.add("error")}function F(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}I.addEventListener("submit",async function(e){e.preventDefault();let t=function(e){let t=0,o=document.querySelectorAll(".required");for(let e=0;e<o.length;e++){const s=o[e];s.classList.remove("error"),s.classList.contains("feedback__input--email")?F(s)&&(M(s),t++):"checkbox"===s.getAttribute("type")&&!1===s.checked?(M(s),t++):""===s.value&&(M(s),t++)}return t}(),o=new FormData(I);if(0===t){Y.classList.add("form--sending");let e=await fetch("sendmail.php",{method:"POST",body:o});if(e.ok){let t=await e.json();O(T,"./img/svg/email-ok.svg",t.message),I.reset(),Y.classList.remove("form--sending")}else O(T,"./img/svg/email-error.svg","Возникла ошибка при отправке формы"),Y.classList.remove("form--sending")}else O(T,"./img/svg/email-error.svg","Заполните обязательные поля")})});